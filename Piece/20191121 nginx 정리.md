# nginx 정리.
### nginx signal 명령어
```
nginx -s {signal}
```
- quit : nginx 종료 (마지막 요청까지 처리한 뒤 종료된다.)
- reload : 설정파일에 대해서 재로딩
- reopen : 로그파일을 재오픈
- stop : 즉시 종료

### nginx 설정 (/etc/nginx/conf.d)
- nginx 설정은 nginx.conf.d 라는 파일을 건드려 설정하여야 한다.
```
- /usr/local/nginx/conf
  
- /etc/nginx

- /usr/local/etc/nginx
```
- __위의 경로중에 nginx 설정파일이 있다.__
  
### Context
- 최상위 탑 레벨에서
```
- events
- http : HTTP traffic
- mail
- stream
```
- http
  - 특정한 도메인 또는 IP 주소에 대한 요청들에 대해 컨트롤한다.
  
### Load Balance
트래픽을 서버 그룹 내에서 로드밸런싱 하기 위한 설정
```
http {

  upstream {groupName} {
    server {server-name}
    server backend1.example.com
    server backend2.example.com
    server 192.0.0.1:8080
  }
}
```

위에서 설정한 서버 그룹을 로드밸런싱 하기위해 ```server``` 블록을 이용한다.
```
http {

  server {
    location / {
       proxy_pass http://{groupName}
    }
  }
}
```

```upstream``` 블록에 로드 밸런싱 알고리즘이 설정되어 있지 않았다. nginx 는 기본적으로 ```ROUND ROBIN``` 방식으로 로드밸런싱 한다.

### Load Balance Method 선택하기
1. Round Robin : ```default```
2. Least Connection : ```least_conn```
3. IP Hash : ```ip_hash```
- 클라이언트 IP 를 해시해서 특정 클라이언트는 특정 서버로 연결하도록 설정. (세션 클러스터링이 구성되지 않은 경우 유용 : 하나의 서버로만 가서 세션을 다른 서버와 동기화 할 필요가 없기 때문.)

> 세션 클러스터링 ? 클러스터링은 여러 대의 서버가 한가지 업무를 수행하는 것을 의미한다. 물리적으로는 분리되어 있어도 논리적으로는 하나인 것이다. 세션 클러스터링이란 WAS 가 두 대 이상 설치되어 있을 경우 세션으로 세션관리하는 것을 의미한다. 
